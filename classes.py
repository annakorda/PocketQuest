import numpy as np

class Protein():
    def __init__(self, direction, name):
        self.__direction = direction
        self.__name = name
        self.__atoms = []
        self.__points = []
    
    def get_name(self):
        return(self.__name)
    
    def get_dir(self):
        return(self.__direction)
    
    def append_atom(self, atom):
        self.__atoms.append(atom)
    
    def get_atoms(self):
        return self.__atoms
    
    def append_point(self, point):
        self.__points.append(point)

    def get_points(self):
        return self.__points
           
class Atom():
    def __init__(self, atom_type, number, residue, coord, bfactor, element):
        self.__type = atom_type
        self.__number = number
        self.__residue = residue
        self.__coordinates = coord
        self.__bfactor = bfactor
        self.__in_pbs = False
        self.__element = element
    
    def get_type(self):
        return self.__type
    
    def get_number(self):
        return self.__number
    
    def get_residue(self):
        return self.__residue

    def get_coord(self):
        return self.__coordinates
    
    def get_bfactor(self):
        return self.__bfactor
    
    def set_in_pbs(self, value = True):
        self.__in_pbs = value

    def get_in_pbs(self):
        return self.__in_pbs
    
    def get_element(self):
        return self.__element
    
class Point():
    def __init__(self, coord, prot):
        self.__coordinates = coord
        self.__protrusion = prot
        self.__atoms = []
    
    def get_coord(self):
        return self.__coordinates

    def calc_dist(self, atom):
        point_coord = np.array(self.get_coord())
        atom_coord = np.array(atom.get_coord())
        return float(np.linalg.norm(point_coord - atom_coord))
    
    def append_atom(self, atom):
        distance = self.calc_dist(atom)
        self.__atoms.append((atom, distance))

    def get_atoms(self):
        return self.__atoms
    
    def get_protrusion(self):
        return self.__protrusion

residues = {
    "ALA" : [
        [1, 0, 1.8, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.77, 0.62, 0, 0, 0],
            "CA" : [-1, 0.63, 0.51, 0, 0, 0],
            "C" : [1, 0.41, 0.35, 0, 0, 0],
            "O" : [1, 0.71, 0.55, 0, 0, 0],
            "CB" : [-1, 1.55, 1.05, 0, 0, 0]
        }
    ],
    "ARG" : [
        [0, 1, -4.5, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1],
        {
            "N" : [1, 0.32, 0.21, 0, 0, 0],
            "CA" : [-1, 0.23, 0.17, 0, 0, 0],
            "C" : [1, 0.16, 0.12, 0, 0, 0],
            "O" : [1, 0.2, 0.18, 0, 0, 0],
            "CB" : [-1, 0.38, 0.26, 0, 0, 0],
            "CG" : [-1, 0.43, 0.28, 0, 0, 0],
            "CD" : [-1, 0.71, 0.43, 0, 0, 0],
            "NE" : [1, 0.99, 0.7, 0, 0, 1],
            "CZ" : [1, 1.33, 0.99, 0, 0, 0],
            "NH1" : [1, 1.62, 1.19, 0, 0, 2],
            "NH2" : [1, 2.05, 1.57, 0, 0, 2]
        }
    ],
    "ASN" : [
        [0, 1, -3.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0],
        {
            "N" : [1, 0.42, 0.32, 0, 0, 0],
            "CA" : [-1, 0.33, 0.31, 0, 0, 0],
            "C" : [1, 0.28, 0.25, 0, 0, 0],
            "O" : [1, 0.45, 0.34, 0, 0, 0],
            "CB" : [-1, 0.54, 0.59, 0, 0, 0],
            "CG" : [1, 0.93, 0.93, 0, 0, 0],
            "OD1" : [1, 1.35, 0.92, 0, 2, 0],
            "ND2" : [1, 1.89, 1.82, 0, 0, 2]
        }
    ],
    "ASP" : [
        [0, 1, -3.5, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1],
        {
            "N" : [1, 0.33, 0.36, 0, 0, 0],
            "CA" : [-1, 0.39, 0.35, 0, 0, 0],
            "C" : [1, 0.27, 0.26, 0, 0, 0],
            "O" : [1, 0.29, 0.39, 0, 0, 0],
            "CB" : [-1, 0.38, 0.47, 0, 0, 0],
            "CG" : [1, 1.32, 0.77, 0, 0, 0],
            "OD1" : [1, 1.93, 1.03, 0, 2, 0],
            "OD2" : [1, 2.16, 1.02, 0, 2, 0]
        }
    ],
    "CYS" : [
        [0, 1, 2.5, 0, 0, 1, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 1, 1],
        {
            "N" : [1, 0.49, 0.39, 0, 0, 0],
            "CA" : [-1, 0.6, 0.79, 0, 0, 0],
            "C" : [1, 0.46, 0.22, 0, 0, 0],
            "O" : [1, 0.79, 0.46, 0, 0, 0],
            "CB" : [-1, 0.9, 1.56, 0, 0, 0],
            "SG" : [1, 1.42, 2.64, 0, 0, 0]
        }
    ],
    "GLN" : [
        [0, 1, -3.5, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0],
        {
            "N" : [1, 0.31, 0.36, 0, 0, 0],
            "CA" : [-1, 0.31, 0.29, 0, 0, 0],
            "C" : [1, 0.23, 0.18, 0, 0, 0],
            "O" : [1, 0.37, 0.32, 0, 0, 0],
            "CB" : [-1, 0.44, 0.45, 0, 0, 0],
            "CG" : [-1, 0.56, 0.5, 0, 0, 0],
            "CD" : [1, 0.98, 0.56, 0, 0, 0],
            "OE1" : [1, 1.52, 0.67, 0, 2, 0],
            "NE2" : [1, 1.58, 1.12, 0, 0, 2]
        }
    ],
    "GLU" : [
        [0, 1, -3.5, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1],
        {
            "N" : [1, 0.21, 0.29, 0, 0, 0],
            "CA" : [-1, 0.24, 0.3, 0, 0, 0],
            "C" : [1, 0.24, 0.19, 0, 0, 0],
            "O" : [1, 0.38, 0.31, 0, 0, 0],
            "CB" : [-1, 0.21, 0.33,	0, 0, 0],
            "CG" : [-1, 0.34, 0.34, 0, 0, 0],
            "CD" : [1, 1.12, 0.71, 0, 0, 0],
            "OE1" : [1, 1.72, 0.96, 0, 2, 0],
            "OE2" : [1, 1.79, 1.07, 0, 2, 0]
        }
    ],
    "GLY" : [
        [1, 0, -0.4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 1.42, 0.84, 0, 0, 0],
            "CA" : [-1, 1.97, 1.46, 0, 0, 0],
            "C" : [1, 0.97, 0.78, 0, 0, 0],
            "O" : [1, 0.93, 0.92, 0, 0, 0]
        }
    ],
    "HIS" : [
        [0, 1, -3.2, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1],
        {
            "N" : [1, 0.2, 0.18, 0, 0, 0],
            "CA" : [-1, 0.23, 0.32, 0, 0, 0],
            "C" : [1, 0.18, 0.19, 0, 0, 0],
            "O" : [1, 0.31, 0.22, 0, 0, 0],
            "CB" : [-1, 0.43, 0.44, 0, 0, 0],
            "CG" : [-1, 0.44, 0.36, 1, 0, 0],
            "ND1" : [1, 0.86, 0.81, 1, 1, 1],
            "CD2" : [-1, 0.98, 1.1, 1, 0, 0],
            "CE1" : [1, 1.45, 1.51, 1, 0, 0],
            "NE2" : [1, 1.79, 2.05, 1, 1, 1], 
        }
    ],
    "ILE" : [
        [1, 0, 4.5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.45, 0.39, 0, 0, 0],
            "CA" : [-1, 0.31, 0.25, 0, 0, 0],
            "C" : [1, 0.24, 0.23, 0, 0, 0],
            "O" : [1, 0.55, 0.42, 0, 0, 0],
            "CB" : [-1, 0.34, 0.24, 0, 0, 0],
            "CG1" : [-1, 0.67, 0.3, 0, 0, 0],
            "CG2" : [-1, 0.97, 0.52, 0, 0, 0],
            "CD1" : [-1, 1.12, 0.68, 0, 0, 0]
        }
    ],
    "LEU" : [
        [1, 0, 3.8, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.48, 0.47, 0, 0, 0],
            "CA" : [-1, 0.29, 0.21, 0, 0, 0],
            "C" : [1, 0.31, 0.22, 0, 0, 0],
            "O" : [1, 0.59, 0.37, 0, 0, 0],
            "CB" : [-1, 0.42, 0.31, 0, 0, 0],
            "CG" : [-1, 0.31, 0.13, 0, 0, 0],
            "CD1" : [-1, 0.99, 0.55, 0, 0, 0],
            "CD2" : [-1, 0.89, 0.62, 0, 0, 0]
        }
    ],
    "LYS" : [
        [0, 1, -3.9, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1],
        {
            "N" : [1, 0.64, 0.29, 0, 0, 0],
            "CA" : [-1, 0.4, 0.25, 0, 0, 0],
            "C" : [1, 0.21, 0.18, 0, 0, 0],
            "O" : [1, 0.22, 0.27, 0, 0, 0],
            "CB" : [-1, 0.45, 0.33, 0, 0, 0],
            "CG" : [-1, 0.49, 0.25, 0, 0, 0],
            "CD" : [-1, 0.56, 0.51, 0, 0, 0],
            "CE" : [-1, 1.34, 0.88, 0, 0, 0],
            "NZ" : [1, 2.42, 1.6, 0, 0, 3]
        }
    ],
    "MET" : [
        [1, 0, 1.9, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.5, 0.39, 0, 0, 0],
            "CA" : [-1, 0.37, 0.34, 0, 0, 0],
            "C" : [1, 0.26, 0.25, 0, 0, 0],
            "O" : [1, 0.47, 0.36, 0, 0, 0],
            "CB" : [-1, 0.62, 0.53, 0, 0, 0],
            "CG" : [-1, 0.75, 0.47, 0, 0, 0],
            "SD" : [1, 0.95, 0.58, 0, 0, 0],
            "CE" : [-1, 1.15, 0.72, 0, 0, 0]
        }
    ],
    "PHE" : [
        [1, 0, 2.8, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.29, 0.41, 0, 0, 0],
            "CA" : [-1, 0.22, 0.3, 0, 0, 0],
            "C" : [1, 0.22, 0.23, 0, 0, 0],
            "O" : [1, 0.43, 0.34, 0, 0, 0],
            "CB" : [-1, 0.5, 0.43, 0, 0, 0],
            "CG" : [-1, 0.45, 0.21, 1, 0, 0],
            "CD1" : [-1, 0.72, 0.37, 1, 0, 0],
            "CD2" : [-1, 0.71, 0.34, 1, 0, 0],
            "CE1" : [-1, 1.01, 0.54, 1, 0, 0],
            "CE2" : [-1, 1, 0.5, 1, 0, 0],
            "CZ" : [-1, 1.16, 0.53, 1, 0, 0]
        }
    ],
    "PRO" : [
        [1, 0, -1.6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [-1, 0.24, 0.41, 0, 0, 0],
            "CA" : [-1, 0.36, 0.43, 0, 0, 0],
            "C" : [1, 0.38, 0.36, 0, 0, 0],
            "O" : [1, 0.76, 0.23, 0, 0, 0],
            "CB" : [-1, 0.63, 0.52, 0, 0, 0],
            "CG" : [-1, 1.01, 0.56, 0, 0, 0],
            "CD" : [-1, 0.99, 0.56, 0, 0, 0]
        }
    ],
    "SER" : [
        [0, 1, -0.8, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0],
        {
            "N" : [1, 0.79, 0.51, 0, 0, 0],
            "CA" : [-1, 0.7, 0.58, 0, 0, 0],
            "C" : [1, 0.41, 0.33, 0, 0, 0],
            "O" : [1, 0.54, 0.53, 0, 0, 0],
            "CB" : [-1, 1.37, 1.08, 0, 0, 0],
            "OG" : [1, 2.05, 1.43, 0, 2, 1] 
        }
    ],
    "THR" : [
        [0, 1, -0.7, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0],
        {
            "N" : [1, 0.69, 0.52, 0, 0, 0],
            "CA" : [-1, 0.51, 0.48, 0, 0, 0],
            "C" : [1, 0.33, 0.31, 0, 0, 0],
            "O" : [1, 0.52, 0.52, 0, 0, 0],
            "CB" : [-1, 0.91, 0.74, 0, 0, 0],
            "OG1" : [1, 1.01, 0.63, 0, 2, 1],
            "CG2" : [-1, 1.8, 1.46, 0, 0, 0]
        }
    ],
    "TRP" : [
        [1, 0, -0.9, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
        {
            "N" : [1, 0.2, 0.36, 0, 0, 0],
            "CA" : [-1, 0.21, 0.19, 0, 0, 0],
            "C" : [1, 0.2, 0.15, 0, 0, 0],
            "O" : [1, 0.33, 0.2, 0, 0, 0],
            "CB" : [-1, 0.49, 0.39, 0, 0, 0],
            "CG" : [-1, 0.52, 0.33, 1, 0, 0],
            "CD1" : [-1, 0.8, 0.58, 1, 0, 0],
            "CD2" : [-1, 0.67, 0.43, 1, 0, 0],
            "NE1" : [1, 1.18, 1.05, 1, 0, 1],
            "CE2" : [-1, 0.95, 0.65, 1, 0, 0],
            "CE3" : [-1, 0.71, 0.49, 1, 0, 0],
            "CZ2" : [-1, 1.14, 0.71, 1, 0, 0],
            "CZ3" : [-1, 0.78, 0.66, 1, 0, 0],
            "CH2" : [-1, 0.93, 0.67, 1, 0, 0]
        }
    ],
    "TYR" : [
        [1, 0, -1.3, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1],
        {
            "N" : [1, 0.2, 0.33, 0, 0, 0],
            "CA" : [-1, 0.22, 0.17, 0, 0, 0],
            "C" : [1, 0.17, 0.2, 0, 0, 0],
            "O" : [1, 0.27, 0.21, 0, 0, 0],
            "CB" : [-1, 0.42, 0.32, 0, 0, 0],
            "CG" : [-1, 0.39, 0.17, 1, 0, 0],
            "CD1" : [-1, 0.59, 0.3, 1, 0, 0],
            "CD2" : [-1, 0.61, 0.27, 1, 0, 0],
            "CE1" : [-1, 0.9, 0.61, 1, 0, 0],
            "CE2" : [-1, 0.88, 0.5, 1, 0, 0],
            "CZ" : [-1, 0.96, 0.62, 1, 0, 0],
            "OH" : [1, 2.03, 1.13, 0, 1, 1]
        }
    ],
    "VAL" : [
        [1, 0, 4.2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        {
            "N" : [1, 0.56, 0.52, 0, 0, 0],
            "CA" : [-1, 0.31, 0.24, 0, 0, 0],
            "C" : [1, 0.3, 0.24, 0, 0, 0],
            "O" : [1, 0.7, 0.42, 0, 0, 0],
            "CB" : [-1, 0.39, 0.26, 0, 0, 0],
            "CG1" : [-1, 0.95, 0.64, 0, 0, 0],
            "CG2" : [-1, 1.07, 0.64, 0, 0, 0]
        }
    ]  
}
